namespace HyperbolicModels
{
	using System.Collections.Generic;
	using System.Drawing;
	using System.Drawing.Imaging;
	using System.Linq;
	using R3.Core;
	using R3.Drawing;
	using R3.Geometry;

	internal class ThreeFifty
	{
		private static List<int[]> AllCells()
		{
			// This is output from the 733 project.
			string[] reflections = 
			{
				"3",
				"3,2",
				"3,2,1",
				"3,2,1,0",
				"3,2,1,0,1",
				"3,2,1,0,1,0",
				"3,2,1,0,1,2",
				"3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2",
				"3,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,0,2",
				"3,2,1,0,1,0,1,2,1",
				"3,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,0,2,1",
				"3,2,1,0,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,2,1,0",
				"3,2,1,0,1,0,1,2,1,3",
				"3,2,1,0,1,0,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,2,1,0,3",
				"3,2,1,0,1,0,1,2,1,3,2",
				"3,2,1,0,1,0,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,3",
				"3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,3",
				"3,2,1,0,1,0,2,1,0,1,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,1,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0,1,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1,2,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1,2,1,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,2,1,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,2,1,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,2,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,2,1,0,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,3",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,3,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,1,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,3",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1",
			};

			List<int[]> result = new List<int[]>();
			foreach( string str in reflections )
			{
				// Ouput from 733 project has mirror indices reversed from here.
				// We want the "across cells" mirror to have index 0, not index 3.
				int[] cellReflections = str.Split( new char[] { ',' } )
					.Select( s => { int r = int.Parse( s ); return 3 - r; } ).ToArray();
				result.Add( cellReflections );
			}
			return result;
		}

		private static List<int[]> TrussReflections()
		{
			// This is output from the 733 project.
			string[] trussReflections = 
			{
				/*
				// Doesn't include starting cell.
				"3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2,3",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,1,0,2,1,0,1,2,3",
				"3,2,1,0,1,0,2,1,0,1,0,1,2,3,2,1,0,1,0,2,1,0,1,0,1,2,3",*/

				// Second truss
				"3,2,1,0,1,0,2,1,0,1,3,2",
				"3,2,1,0,1,0,2,1,0,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,1,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,1,3,2,1,0,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,1,0,3,2,1,0,1,0,1,0",
				/*
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2,1,0,1",

				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,3,2",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,1,0,2,1,0,1,3,2,1,0,1,0,2,1,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0",
				"3,2,1,0,1,0,1,0,2,1,0,1,2,3,2,1,0,1,0,2,1,0,3,2,1,0",
				"3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1",
				"3,2,1,0,1,0,2,1,0,3,2,1,0,1,0,1,2,1,0,3,2,1,0,1,0,1*/
			};

			List<int[]> result = new List<int[]>();
			foreach( string str in trussReflections )
			{
				// Ouput from 733 project has mirror indices reversed from here.
				// We want the "across cells" mirror to have index 0, not index 3.
				int[] cellReflections = str.Split( new char[] { ',' } )
					.Select( s => { int r = int.Parse( s ); return 3 - r; } ).ToArray();
				result.Add( cellReflections );
			}
			return result;
		}

		private static Sphere[] Simplex( ref Vector3D cen )
		{
			int p = 7;
			int q = 3;
			int r = 3;

			// For vertex-centered.
			//Vector3D v = SimplexCalcs.VertexPointBall( p, q, r );
			//v = H3Models.BallToUHS( v );

			bool ball = true;
			Sphere[] simplex = SimplexCalcs.Mirrors( p, q, r, ref cen, moveToBall: ball /*, scaling: 1.0/v.Abs()*/ );
			return simplex;
		}

		public static void PovRayModel()
		{
			Vector3D cen = HoneycombPaper.InteriorPointBall;
			cen = H3Models.BallToUHS( cen );
			Sphere[] simplex = Simplex( ref cen );

			H3.Cell[] simplicesFinal = GenTruss( simplex, null, cen, ball: true );
			string fileName = "350cell.pov";
			System.IO.File.Delete( fileName );
			foreach( H3.Cell cell in simplicesFinal )
			{
				//int[] include = new int[] { 0, 1, 2, 3 };
				int[] include = new int[] { 0 };
				PovRay.AppendSimplex( cell.Facets.Select( f => f.Sphere ).ToArray(), cell.Center, include, fileName );
			}

			/*
			HashSet<H3.Cell.Edge> axes = new HashSet<H3.Cell.Edge>( new H3.Cell.EdgeEqualityComparer() );
			H3.Cell.Edge axis = new H3.Cell.Edge( new Vector3D( 0, 0, -1 ), new Vector3D( 0, 0, 1 ) );
			axes.Add( axis );
			foreach( int[] reflections in TrussReflections() )
			{
				Vector3D s = axis.Start, e = axis.End;
				foreach( int ri in reflections )
				{
					s = simplex[ri].ReflectPoint( s );
					e = simplex[ri].ReflectPoint( e );
				}
				axes.Add( new H3.Cell.Edge( s, e ) );
			}
			PovRay.WriteH3Edges( new PovRay.Parameters { AngularThickness = 0.045 }, axes.ToArray(), "axes.pov" );

			H3.Cell.Edge[] fibers = new H3.Cell.Edge[] { axis };
			fibers = Recurse.CalcEdges( simplex.Skip(1).ToArray(), fibers );
			PovRay.WriteH3Edges( new PovRay.Parameters { AngularThickness = 0.025 }, fibers, "axes.pov" );*/
		}

		private static H3.Cell[] GenTruss( Sphere[] simplex, Mesh mesh, Vector3D cen, bool ball )
		{
			// We don't want to include the first mirror (which reflects across cells).
			Sphere[] mirrors = simplex.Skip( 1 ).ToArray();
			Sphere[] allMirrors = simplex.ToArray();

			// Simplices will be the "cells" in Recurse.CalcCells.
			H3.Cell.Facet[] simplexFacets = simplex.Select( m => new H3.Cell.Facet( m ) ).ToArray();

			H3.Cell startingCell = new H3.Cell( simplexFacets );
			startingCell.Center = cen;

			//FCOrient( startingCell );
			//return null;

			startingCell = startingCell.Clone();	// So our mirrors don't get munged after we reflect around later.
			H3.Cell[] simplices = Recurse.CalcCells( mirrors, new H3.Cell[] { startingCell }, new Recurse.Settings() { Ball = ball } );
			//H3.Cell[] simplices = new H3.Cell[] { startingCell };

			// Subsets
			//return simplices.Where( s => s.Depths[0] == 1 ).ToArray();
			//return simplices.ToArray();

			List<H3.Cell> final = new List<H3.Cell>();
			final.AddRange( simplices );

			// Add in other truss cells.
			Recurse.Settings settings = new Recurse.Settings();
			foreach( int[] reflections in TrussReflections() )
			foreach( H3.Cell c in simplices )
			{
				H3.Cell clone = c.Clone();
				foreach( int r in reflections )
					clone.Reflect( allMirrors[r] );
				if( Recurse.CellOk( clone, settings ) )
					final.Add( clone );
			}

			return final.ToArray();
		}

		public static void GenImage()
		{
			int size = 1000;
			Bitmap image = new Bitmap( size, size );
			ImageSpace i = new ImageSpace( size, size );
			double b = 1.1;
			i.XMin = -b; i.XMax = b;
			i.YMin = -b; i.YMax = b;

			Vector3D cen = HoneycombPaper.InteriorPointBall;
			cen = H3Models.BallToUHS( cen );
			Sphere[] simplex = Simplex( ref cen );

			Sphere inSphere = InSphere( simplex );

			using( Graphics g = Graphics.FromImage( image ) )
			foreach( int[] reflections in AllCells() )
			{
				Sphere clone = inSphere.Clone();
				foreach( int r in reflections )
					clone.Reflect( simplex[r] );


				Sphere ball = new Sphere();
				Circle3D inSphereIdealBall = ball.Intersection( clone );
				Circle3D inSphereIdealUHS = H3Models.BallToUHS( inSphereIdealBall );
				Circle inSphereIdeal = new Circle { Center = inSphereIdealUHS.Center, Radius = inSphereIdealUHS.Radius };

				using( Brush brush = new SolidBrush( Color.Blue ) )
					DrawUtils.DrawFilledCircle( inSphereIdeal, g, i, brush );
			}

			image.Save( "threefifty.png", ImageFormat.Png );
		}

		private static Sphere InSphere( Sphere[] simplex )
		{
			// The point centered on a face is the closest point of the cell mirror to the origin.
			Vector3D facePoint = simplex[0].ProjectToSurface( new Vector3D() );

			// Reflect it to get 3 more points on our insphere.
			Vector3D reflected1 = simplex[2].ReflectPoint( facePoint );
			Vector3D reflected2 = simplex[1].ReflectPoint( reflected1 );
			Vector3D reflected3 = simplex[3].ReflectPoint( reflected2 );
			Sphere inSphere = Sphere.From4Points( facePoint, reflected1, reflected2, reflected3 );
			return inSphere;
		}
	}
}
